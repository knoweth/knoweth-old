<?use k:com.github.knoweth.client.components?>
<div class="k-pg-document">
    <std:if condition="document != null">
        <h1>Document #
            <html:text value="id"/>
            -
            <html:text value="document.title"/>
        </h1>
        <p>
            <strong>Author</strong>:
            <html:text value="document.author"/>
        </p>

        <std:foreach var="section" index="sectionId" in="document.sections">
            <h2><input html:change="section.title" html:value="section.title" class="k-input--no-styling"></h2>

            <table class="table">
                <thead>
                <tr>
                    <th>Edit</th>
                    <th>Preview</th>
                </tr>
                </thead>

                <tbody>
                <std:foreach var="note" in="section.notes">
                    <tr>
                        <td>
                            <div class="k-note">
                                <textarea class="k-note__front" html:value="note.front" html:change="note.front"
                                          placeholder="Note Front"></textarea>
                                <textarea class="k-note__back" html:value="note.back" html:change="note.back"
                                          placeholder="Note Back"></textarea>
                            </div>
                        </td>
                        <td>
                            <k:markdown content="note.front"/>
                        </td>
                    </tr>
                </std:foreach>
                </tbody>
            </table>

            <p>
                <button class="btn btn-primary" event:click="addNote(sectionId)">Add Note</button>
            </p>
        </std:foreach>

        <button class="btn btn-primary" event:click="addSection()">Add Section</button>

        <button class="btn btn-success" event:click="save()">Save</button>

        <std:if condition="saveMessage != null">
            <p>
                <html:text value="saveMessage"/>
            </p>
        </std:if>
    </std:if>
</div>