<?use k:com.github.knoweth.client.components?>

<div class="k-pg-document">
    <std:if condition="document != null">
        <h1>Document #
            <html:text value="id"/>
            â€”
            <input html:change="document.title" html:value="document.title" class="k-input--no-styling">
        </h1>
        <p>
            <strong>Author</strong>:
            <html:text value="document.author"/>
        </p>

        <std:foreach var="section" index="sectionId" in="document.sections">
            <h2><input html:change="section.title" html:value="section.title" class="k-input--no-styling"></h2>

            <table class="table">
                <thead>
                <tr>
                    <th>Edit</th>
                    <th>Preview</th>
                </tr>
                </thead>

                <tbody>
                <std:foreach var="note" in="section.notes" index="noteId">
                    <tr>
                        <td style="width: 50%">
                            <select html:value="note.type" html:change="note.setType(Integer.parseInt(it))">
                                <option value="0">One-sided</option>
                                <option value="1">Two-sided</option>
                            </select>
                            <div class="k-note card">
                                <textarea class="k-note__front" html:value="note.front" html:change="note.front"
                                          placeholder="Note Front"></textarea>
                                <textarea class="k-note__back" html:value="note.back" html:change="note.back"
                                          placeholder="Note Back"></textarea>
                                <div class="card-footer">
                                    <button class="btn btn-danger" event:click="removeNote(sectionId, noteId)">
                                        <i class="fas fa-trash"></i> Remove
                                    </button>
                                </div>
                            </div>
                        </td>
                        <td style="width: 50%">
                            <div class="k-note card">
                                <div class="k-note__front">
                                    <k:markdown content="note.front"/>
                                </div>
                                <div class="k-note__back">
                                    <k:markdown content="note.back"/>
                                </div>
                            </div>
                        </td>
                    </tr>
                </std:foreach>
                </tbody>
            </table>

            <p>
                <button class="btn btn-primary" event:click="addNote(sectionId)">Add Note</button>
            </p>
        </std:foreach>

        <button class="btn btn-primary" event:click="addSection()">Add Section</button>

        <button class="btn btn-success" event:click="save()">Save</button>

        <std:if condition="saveMessage != null">
            <p>
                <html:text value="saveMessage"/>
            </p>
        </std:if>
    </std:if>
</div>